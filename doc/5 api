CONTROLLER API

Lua runtime API:

    local kryon = require("kryon")

    -- Filesystem
    kryon.mount("/mnt/kryon")
    kryon.unmount()

    -- Window management
    local win = kryon.create_window("Title", 800, 600)
    win.title = "New Title"
    win.rect = "100 100 800 600"
    win.visible = 1
    win:show()
    win:hide()
    win:destroy()

    -- Widget management
    local btn = kryon.widget("btn_id")
    local new_btn = kryon.create_widget("button", parent_id)
    btn.text = "Click Me"
    btn.value = "state"
    btn.visible = 1
    btn.enabled = 1
    btn:focus()
    btn:show()
    btn:hide()

    -- Event handlers
    btn.on_click(function()
        print("Clicked!")
    end)

    btn.on_change(function(new_val)
        print("Value: " .. new_val)
    end)

    btn.on_focus(function()
        print("Focused")
    end)

    -- Layout loading
    kryon.load("app.kryon")

    -- Event loop
    kryon.run()
    kryon.quit()

C API (direct 9P):

    #include <9p.h>
    #include <libc.h>

    int fd;
    char buf[256];

    // Create window
    fd = open("/mnt/kryon/ctl", O_WRONLY);
    write(fd, "create_window", 13);
    close(fd);

    // Set title
    fd = open("/mnt/kryon/windows/1/title", O_WRONLY);
    write(fd, "My App", 6);
    close(fd);

    // Create widget
    fd = open("/mnt/kryon/ctl", O_WRONLY);
    write(fd, "create_widget 1 button 0", 24);
    close(fd);

    // Set text
    fd = open("/mnt/kryon/windows/1/widgets/1/text", O_WRONLY);
    write(fd, "Click Me", 8);
    close(fd);

    // Read events
    fd = open("/mnt/kryon/windows/1/widgets/1/event", O_RDONLY);
    while (read(fd, buf, sizeof(buf)) > 0) {
        printf("Event: %s\n", buf);
    }

Shell (rc) scripting:

    # Create window
    echo create_window > /mnt/kryon/ctl

    # Set title
    echo My App > /mnt/kryon/windows/1/title

    # Create button
    echo 'create_widget 1 button 0' > /mnt/kryon/ctl

    # Event loop
    while () {
        event=`{cat /mnt/kryon/windows/1/widgets/1/event}
        if (~ $event()) {
            echo Button clicked!
        }
    }

Python (via 9pclient):

    import p9

    kryon = p9.mount("tcp!localhost!17019", "/mnt/kryon")

    # Create window
    kryon.ctl.write("create_window")
    kryon.windows[1].title.write("My App")

    # Create button
    kryon.ctl.write("create_widget 1 button 0")
    kryon.windows[1].widgets[1].text.write("Click Me")

    # Event loop
    for event in kryon.windows[1].widgets[1].event.events():
        if event == "clicked":
            print("Clicked!")

EXAMPLES

These examples demonstrate how to interact with Kryon via direct 9P shell 
commands, the .kryon DSL, and high-level Lua/C controllers.

---

1. Hello World (Direct 9P Shell)
This shows how to build a UI using only standard Marrow/Plan 9 tools.

    # 1. Create a top-level window
    echo '{"title":"Hello", "w":400, "h":300}' > /wm/ctl
    
    # 2. Set position manually (using window ID 1)
    echo "100 100 400 300" > /wm/win/1/rect
    
    # 3. Create a label widget
    echo "type=label" > /wm/win/1/widgets/new
    
    # 4. Set the label text
    echo "Welcome to Marrow!" > /wm/win/1/widgets/1/text



---

2. Counter (.kryon layout + Lua)
A classic interactive app using the Kryon DSL and Lua controller.

    # counter.kryon
    window counter "Counter" 300 200 {
        vbox gap=10 padding=20 {
            label lbl_count "Count: 0" align="center"
            hbox {
                button btn_inc "+"
                button btn_dec "-"
            }
        }
    }

    # counter.lua
    local kryon = require("kryon")
    kryon.load("counter.kryon")

    local count = 0
    local lbl = kryon.widget("counter.lbl_count")

    kryon.widget("counter.btn_inc").on_click(function()
        count = count + 1
        lbl.text = "Count: " .. count
    end)

    kryon.widget("counter.btn_dec").on_click(function()
        count = count - 1
        lbl.text = "Count: " .. count
    end)

    kryon.run()

---

3. Habits App with Nesting
Demonstrating recursive windows for a "Settings" sub-interface.

    # habits.kryon
    window habits "Daily Habits" 400 600 {
        vbox padding=10 {
            label "My Tasks"
            scrollarea tasks {
                vbox id=task_list {
                    checkbox t1 "Hydrate"
                }
            }
            button btn_settings "Settings"
        }
    }

    # In Lua, opening a nested window on click:
    kryon.widget("habits.btn_settings").on_click(function()
        -- Create a nested window inside 'habits'
        local win = kryon.create_window("habits.win.settings", {
            title = "Settings",
            w = 200, h = 150
        })
        -- Add a mode-switch button inside it
        win.add_widget("button", "btn_mode", "Toggle TTY/GUI")
    end)



---

4. Event Loop (C)
Directly reading the 9P event stream for a specific widget.

    /* Open the event file for a specific button */
    int fd = open("/wm/win/1/widgets/1/events", O_RDONLY);
    char buf[256];

    while (1) {
        /* Read blocks until an event occurs */
        int n = read(fd, buf, sizeof(buf)-1);
        if (n <= 0) break;

        buf[n] = '\0';
        
        /* Example event: "clicked x=45 y=12 button=1" */
        if (strncmp(buf, "clicked", 7) == 0) {
            /* Update a property file in response */
            int pfd = open("/wm/win/1/widgets/2/text", O_WRONLY);
            write(pfd, "Action Taken!", 13);
            close(pfd);
        }
    }

---

5. Headless Mode Switching
Switching between TTY and Graphical modes via the shell.

    # Check current mode
    cat /wm/mode
    
    # Switch to TTY (for Serial Console/RISC-V)
    echo "tty" > /wm/mode
    
    # The habits app now renders as:
    # [ My Tasks ]
    # [X] Hydrate
    # < Settings >
INTRO

Kryon is a window manager and widget service that provides a synthetic 
UI filesystem using the 9P2000 protocol. It runs as an optional extension 
to Marrow, transforming raw device files into structured, semantic widgets.

ARCHITECTURE

Kryon attaches to Marrow's hardware namespace and re-exports a managed UI:

    Marrow (Core Substrate)
        ├── /dev/draw          Raw Graphics (Plan 9)
        ├── /dev/cons          Raw Console I/O
        ├── /dev/mouse         Mouse input
        └── /dev/kbd           Keyboard input
            ↓ 9P (Kryon Attaches)
    Kryon (Unified WM Service)
        ├── Renderer Logic     [Display Mode | TTY Mode]
        ├── Window Manager     Manages window stacks and focus
        ├── Widget System      Semantic UI (Buttons, Lists, etc.)
        └── /wm                The UI Management Filesystem

KEY FEATURES

1. Dual Rendering - Render widgets as pixels (/dev/draw) or text (/dev/cons).
2. Semantic UI - Interact with widgets as files (e.g., /wm/habits/gym/status).
3. Mode Agnostic - The same 9P messages drive both a GUI and a TTY.
4. Hot-Swapping - Toggle between graphical and text modes via /wm/ctl.
5. Legacy Support - Provides a virtual /wm/dev/draw for pixel-direct apps (Acme).

OPERATING MODES

Kryon is a standalone cell. If not running, Marrow remains a "naked" kernel.

    # Start Marrow (Headless/Kernel only)
    marrow --port 17010

    # Start Kryon (Connects to Marrow as a client)
    # Use -t for TTY-only mode (Serial/RISC-V) or -d for Display mode (Pi/GPU)
    kryon --marrow localhost:17010 --mode display

    # Kryon posts its service to /srv/kryon
    # Standard practice is to mount the service to /wm
    mount /srv/kryon /wm

QUICK START

    # Boot the substrate
    ./marrow/bin/marrow &
    
    # Launch the WM Extension
    ./kryon/bin/kryon &

    # Interaction via CLI or Script:
    cd /wm
    
    # Switch to TTY mode on the fly
    echo "mode tty" > ctl
    
    # Create a new windowed app entry
    mkdir habits
    echo '{"title":"Daily Habits","type":"grid"}' > habits/ctl

    # Check off a habit via file write (Agentic friendly)
    echo 1 > habits/water_intake/value

See /docs/widgets.md for a full list of the 89 supported widget types.
PROTOCOL

Kryon speaks 9P2000 with Marrow. All UI state is a synthetic filesystem 
mounted at /wm. If the service is not running, /wm is unmounted.

WINDOW MANAGER HIERARCHY (RECURSIVE)

Kryon provides a nested window interface at /wm. Every window is a 
container that can hold widgets OR other windows.

    /wm/
    ├── ctl                 Global WM control (write JSON)
    ├── version             "Kryon 1.0"
    ├── mode                "display" or "tty" (read/write)
    └── win/                Top-level windows
        └── [id]/           Recursive Window Entry
            ├── ctl         Window control (move, resize, hide)
            ├── title       Window title
            ├── rect        Position "x,y,w,h" (relative to parent)
            ├── win/        NESTED WINDOWS (Recursive)
            │   └── [id]/   Sub-window with its own widgets/win/
            ├── widgets/    Widget tree for this level
            │   └── [id]/
            │       ├── type
            │       ├── properties/
            │       └── events
            ├── events      Window-level events
            └── dev/        
                └── draw    Virtual draw device for this window

CONTROL INTERFACE

Create a top-level window:
    echo '{"title":"Parent"}' > /wm/ctl

Create a nested window (inside window 1):
    echo '{"title":"Child"}' > /wm/win/1/ctl

Widget management:
    # Create widget in a specific nested window
    echo "type=button" > /wm/win/1/win/2/widgets/new



EVENT FORMAT

Events include the path to the origin window/widget to handle nesting:
    /win/1/win/2/widgets/5 clicked x=10 y=5 button=1

WIDGET TYPES (89 TOTAL)

Kryon ensures widgets degrade gracefully from Display to TTY mode.

    Input:      button, checkbox, radio, textbox, slider, list
    Display:    label, image, icon, progress, chart, graph
    Container:  box, hbox, vbox, grid, frame, tab, split
    Special:    terminal, editor, console, filepicker, map

PERMISSIONS

    /wm/ctl                  0222    write-only
    /wm/mode                 0644    read/write
    /wm/win/                 0755    listable
    /wm/win/*/...            0644    recursive read/write access

ERROR CODES

    EPERM           Operation not permitted
    ENOENT          File not found
    EINVAL          Invalid argument (e.g., recursive loop)
    ENOSPACE        No space (max nesting depth reached)
    